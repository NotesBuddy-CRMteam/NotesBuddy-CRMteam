<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PSF Contact Notes</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="auth.js"></script>
</head>
<body class="bg-gray-100 text-gray-800 p-4">
  <!-- Nav Bar -->
  <nav class="mb-3">
    <div class="max-w-3xl mx-auto flex justify-between items-center bg-white border border-gray-200 rounded-xl py-3 px-6 shadow-sm">
      <span class="italic font-bold text-[1.5rem] tracking-wide" style="color: #eb441a;">Notes Buddy</span>
      <div class="flex gap-6 items-center">
        <a href="psf-contact-notes.html" class="text-gray-700 font-medium hover:underline transition">PSF Contact Notes</a>
        <a href="booking-contact-notes.html" class="text-gray-700 font-medium hover:underline transition">Booking Contact Notes</a>
        <button onclick="Return()" class="ml-4 px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition font-medium">Return</button>
      </div>
    </div>
  </nav>
  <div class="max-w-3xl mx-auto bg-white p-6 rounded-xl shadow space-y-6">
    <h1 class="text-2xl font-bold text-center">PSF Contact Notes</h1>

    <!-- Gender and Email Survey -->
    <div class="space-y-4">
      <div>
        <label class="font-semibold block mb-2">Select Gender:</label>
        <div class="flex gap-6">
          <label class="flex items-center text-lg space-x-2">
            <input type="radio" name="gender" value="he" checked class="w-5 h-5" onchange="updateGenderedMisc()"> <span>He</span>
          </label>
          <label class="flex items-center text-lg space-x-2">
            <input type="radio" name="gender" value="she" class="w-5 h-5" onchange="updateGenderedMisc()"> <span>She</span>
          </label>
        </div>
      </div>

      <div>
        <label class="font-semibold block mb-2">Email Survey Campaign:</label>
        <label class="flex items-center text-lg space-x-2">
          <input type="checkbox" id="emailSurvey" class="w-5 h-5"> <span>Customer was part of an email campaign</span>
        </label>
      </div>
    </div>

    <!-- Satisfaction -->
    <div>
      <label class="font-semibold block mb-2">Satisfaction Status:</label>
      <button onclick="generateNote('satisfied')" class="px-4 py-2 bg-green-600 text-white rounded mr-2">Satisfied</button>
      <button onclick="generateNote('not satisfied')" class="px-4 py-2 bg-red-600 text-white rounded">Not Satisfied</button>
    </div>

    <!-- Generated Note -->
    <div>
      <h2 class="font-semibold mb-1">Generated Note:</h2>
      <div id="note" class="bg-gray-100 p-3 border rounded min-h-[60px] whitespace-pre-wrap"></div>
      <button onclick="copyText('note')" class="mt-2 px-3 py-1 bg-blue-600 text-white rounded">Copy Note</button>
    </div>

    <!-- Misc Notes -->
    <div>
      <h2 class="font-semibold mb-2">Misc Notes:</h2>
      <div class="space-y-2">
        <div class="flex items-start space-x-2">
          <button onclick="copyText('misc1')" class="text-sm text-blue-600 underline">Copy</button>
          <span id="misc1">The customer was unable to be contacted after several attempts.</span>
        </div>
        <div class="flex items-start space-x-2">
          <button onclick="copyText('misc2')" class="text-sm text-blue-600 underline">Copy</button>
          <span id="misc2">The customer advised that he was not willing to be surveyed.</span>
        </div>
        <div class="flex items-start space-x-2">
          <button onclick="copyText('misc3')" class="text-sm text-blue-600 underline">Copy</button>
          <span id="misc3">The customer advised that he was satisfied with his service experience however felt that 7 was an appropriate score.</span>
        </div>
        <div class="flex items-start space-x-2">
          <button onclick="copyText('misc4')" class="text-sm text-blue-600 underline">Copy</button>
          <span id="misc4">N/A</span>
        </div>
        <div class="flex items-start space-x-2">
          <button onclick="copyText('misc5')" class="text-sm text-blue-600 underline">Copy</button>
          <span id="misc5">Yes</span>
        </div>
        <div class="flex items-start space-x-2">
          <button onclick="copyText('misc6')" class="text-sm text-blue-600 underline">Copy</button>
          <span id="misc6">The customer confirmed that the email address on file is correct.</span>
        </div>
      </div>
    </div>

    <!-- Action Banners -->
    <div>
      <h2 class="font-semibold mb-2">Action Banners:</h2>
      <div class="space-y-2">
        <div class="flex items-start space-x-2">
          <button onclick="copyText('action1')" class="text-sm text-blue-600 underline">Copy</button>
          <span id="action1">***ACTION REQUIRED - CUSTOMER REQUESTED A CALLBACK***</span>
        </div>
        <div class="flex items-start space-x-2">
          <button onclick="copyText('action2')" class="text-sm text-blue-600 underline">Copy</button>
          <span id="action2">***ACTION REQUIRED - CUSTOMER REQUESTED AN INVOICE BE SENT***</span>
        </div>
        <div class="flex items-start space-x-2">
          <button onclick="copyText('action3')" class="text-sm text-blue-600 underline">Copy</button>
          <span id="action3">***ACTION REQUIRED - DEALERSHIP TO UPDATE RECORDS***</span>
        </div>
        <div class="flex items-start space-x-2">
          <button onclick="copyText('action4')" class="text-sm text-blue-600 underline">Copy</button>
          <span id="action4">***ACTION REQUIRED - CUSTOMER REQUESTED MORE INFORMATION***</span>
        </div>
        <div class="flex items-start space-x-2">
          <button onclick="copyText('action5')" class="text-sm text-blue-600 underline">Copy</button>
          <span id="action5">***ACTION REQUIRED - CUSTOMER REQUESTED A CALL BACK WITH A QUOTE***</span>
        </div>
        <div class="flex items-start space-x-2">
          <button onclick="copyText('action6')" class="text-sm text-blue-600 underline">Copy</button>
          <span id="action6">***ACTION REQUIRED - CUSTOMER REQUESTED TO BE UNSUBSCRIBED***</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast message -->
  <div id="copyToast" class="fixed bottom-5 right-5 bg-black text-white px-4 py-2 rounded shadow-lg text-sm hidden">
    Copied!
  </div>

  <script>
    // --- Auth check on page load ---
    requireAuth();

    function Return() {
      clearAuth();
      window.location.href = "index.html";
    }

    function getGender() {
      return document.querySelector('input[name="gender"]:checked').value;
    }

    function getPossessive(gender) {
      return gender === 'he' ? 'his' : 'her';
    }

    function capitalize(word) {
      return word.charAt(0).toUpperCase() + word.slice(1);
    }

    function generateNote(status) {
      const gender = getGender();
      const hisHer = getPossessive(gender);
      const emailSurvey = document.getElementById("emailSurvey").checked;

      let note = `The customer advised that ${gender} was ${status} with ${hisHer} service experience. ${capitalize(gender)} has confirmed that the email address on file is correct.`;

      if (status === "satisfied" && emailSurvey) {
        note += " The customer was notified about the email survey.";
      }

      document.getElementById("note").innerText = note;
    }

    function copyText(id) {
      const text = document.getElementById(id).innerText;
      navigator.clipboard.writeText(text).then(() => {
        const toast = document.getElementById("copyToast");
        toast.classList.remove("hidden");
        setTimeout(() => toast.classList.add("hidden"), 1500);
      });
    }

    function updateGenderedMisc() {
      const gender = getGender();
      const hisHer = getPossessive(gender);

      document.getElementById("misc2").innerText = `The customer advised that ${gender} was not willing to be surveyed.`;
      document.getElementById("misc3").innerText = `The customer advised that ${gender} was satisfied with ${hisHer} service experience however felt that 7 was an appropriate score.`;
    }

    window.onload = () => {
      requireAuth();
      updateGenderedMisc();
    };
  </script>
</body>
</html>
